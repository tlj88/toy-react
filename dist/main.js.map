{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./main.js","webpack:///./toy-react.js"],"names":["Square","props","onClick","value","Component","Board","state","squares","Array","fill","xIsNext","i","slice","setState","handleClick","status","renderSquare","Game","render","document","getElementById","RENDER_TO_DOM","Symbol","ElementWrapper","tagName","root","createElement","name","match","addEventListener","RegExp","$1","replace","c","toLocaleLowerCase","setAttribute","child","range","createRange","setStart","childNodes","length","setEnd","deleteContents","insertNode","TextWrapper","content","createTextNode","_root","attributes","children","_range","push","newState","rerender","merge","oldState","p","insertChild","parent","appendChild","type","e","key","component","mountEle"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./main.js\");\n","import { createElement, Component, render } from './toy-react.js'\n\n\n\n// function Square(props) {\n//     return (\n//         <button class=\"square\" onClick={props.onClick}>\n//             {props.value}\n//         </button>\n//     );\n// }\nclass Square extends Component { \n    constructor(props) { \n        super(props)\n    }\n    render() { \n        return (\n            <button class=\"square\" onClick={this.props.onClick}>\n                {this.props.value}\n            </button>\n        );\n    }\n}\n\nclass Board extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            squares: Array(9).fill(null),\n            xIsNext: true,\n        };\n    }\n\n    handleClick(i) {\n        const squares = this.state.squares.slice();\n        squares[i] = this.state.xIsNext ? 'X' : 'O';\n        this.setState({\n            squares: squares,\n            xIsNext: !this.state.xIsNext,\n        });\n    }\n\n    renderSquare(i) {\n        return (\n            <Square\n                value={this.state.squares[i]}\n                onClick={() => this.handleClick(i)}\n            />\n        );\n    }\n\n    render() {\n        const status = 'Next player: ' + (this.state.xIsNext ? 'X' : 'O');\n\n        return (\n            <div>\n                <div class=\"status\">{status}</div>\n                <div class=\"board-row\">\n                    {this.renderSquare(0)}\n                    {this.renderSquare(1)}\n                    {this.renderSquare(2)}\n                </div>\n                <div class=\"board-row\">\n                    {this.renderSquare(3)}\n                    {this.renderSquare(4)}\n                    {this.renderSquare(5)}\n                </div>\n                <div class=\"board-row\">\n                    {this.renderSquare(6)}\n                    {this.renderSquare(7)}\n                    {this.renderSquare(8)}\n                </div>\n            </div>\n        );\n    }\n}\n\nclass Game extends Component {\n    render() {\n        return (\n            <div class=\"game\">\n                <div class=\"game-board\">\n                    <Board />\n                </div>\n                <div class=\"game-info\">\n                    <div>{/* status */}</div>\n                    <ol>{/* TODO */}</ol>\n                </div>\n            </div>\n        );\n    }\n}\n\nrender(\n    <Game />,\n    document.getElementById('root')\n);\n\n\n\n\n// class MyComponent extends Component {\n//     constructor(props) { \n//         super(props)\n//         this.state = {\n//             a: 1,\n//             b: 2\n//         }\n//     }\n//     render() { \n//         return <div class=\"my-component\">\n//             <h1>my component</h1>\n//             <button onclick={() => { this.setState({ a: this.state.a++ })}}>click</button>\n//             <span>{this.state.a.toString()}</span>\n//             <span>{this.state.b.toString()}</span>\n//         </div>\n//     }\n// }\n\n\n// // jsx\n// render(<MyComponent id=\"app\" class=\"test\">\n//     <div>bjyx</div>\n//     <div></div>\n//     <div></div>\n// </MyComponent>, document.getElementById('app'))","const RENDER_TO_DOM = Symbol('render to dom')\n\n// 原生的DOM对象是无论如何都没有办法去appendChild一个component的，\n// 所以给原生dom对象封一层wrapper, wrapper具有setAttribute和appendChild方法，同时component也具有setAttribute和appendChild方法\nclass ElementWrapper { \n    constructor(tagName) { \n        this.root = document.createElement(tagName)\n    }\n\n    setAttribute(name, value) { \n        if (name.match(/^on([\\s\\S]+)/)) {\n            // RegExp.$1\n            this.root.addEventListener(RegExp.$1.replace(/^[\\s\\S]/, c => c.toLocaleLowerCase()), value)\n        } else { \n            this.root.setAttribute(name, value)\n        }\n    }\n    appendChild(child) { \n        // if (child.root) { \n            // this.root.appendChild(child.root)\n            let range = document.createRange()\n            range.setStart(this.root, this.root.childNodes.length)\n            range.setEnd(this.root, this.root.childNodes.length)\n            child[RENDER_TO_DOM](range)\n        // }\n    }\n\n    [RENDER_TO_DOM](range) { \n        range.deleteContents()\n        range.insertNode(this.root)  // 插入到末尾\n    }\n}\n\nclass TextWrapper { \n    constructor(content) { \n        this.root = document.createTextNode(content)\n    }\n    [RENDER_TO_DOM](range) { \n        range.deleteContents()\n        range.insertNode(this.root)  // 插入到末尾\n    }\n}\n\nclass Component { \n    constructor(props) { \n        this._root = null\n        this.props = props\n        this.attributes = {}\n        this.children = []\n        this._range = null\n    }\n    setAttribute(name, value) { \n        this.attributes[name] = value    // props还未实现\n    }\n    appendChild(child) {    // component 添加 \n        this.children.push(child)\n    }\n    [RENDER_TO_DOM](range) { \n        this._range = range\n        this.render()[RENDER_TO_DOM](range)\n    }\n    rerender() { \n        this._range.deleteContents()\n        this[RENDER_TO_DOM](this._range)\n    }\n    setState(newState) { \n        if (this.state === null || typeof this.state !== 'object') { \n            this.state = newState\n            this.rerender()\n            return\n        }\n        let merge = (oldState, newState) => { \n            for (let p in newState) { \n                if (oldState[p] === null || typeof oldState !== 'object') {\n                    oldState[p] = newState[p]\n                } else { \n                    merge(oldState[p], newState[p])\n                }\n            }\n        }\n        merge(this.state, newState)\n        this.rerender()\n    }\n    // 第1课\n    // get root() { \n    //     if (!this._root) { \n    //         this._root = this.render().root\n    //     }\n    //     return this._root\n    // }\n}\n\nfunction insertChild(child, parent) { \n    if (\n        typeof child == 'object' &&\n        child instanceof Array\n    ) { \n        for (let c of child) { \n            insertChild(c, parent)\n        }\n    }\n    if (typeof child === 'string') {\n        child = new TextWrapper(child)\n    }\n    parent.appendChild(child)\n}\n\n/**\n * @param {*} type \n * @param {*} attributes \n * @param  {...any} children \n */\nfunction createElement(type, attributes, ...children) {\n    let e\n    if (typeof type === 'string') {\n        e = new ElementWrapper(type)\n    } else {\n        e = new type()\n    }\n    if(attributes) {\n        for(let key in attributes) {\n            let value = attributes[key]\n            e.setAttribute(key, value)\n        }\n    }\n    if (children) {\n        for (let child of children) {\n            insertChild(child, e)          \n        }\n    }\n    return e\n}\n\nfunction render(component, mountEle) { \n    // 第1课\n    // mountEle.appendChild(component.root)\n    let range = document.createRange()\n    range.setStart(mountEle, 0)\n    range.setEnd(mountEle, mountEle.childNodes.length)\n    range.deleteContents()\n    component[RENDER_TO_DOM](range)\n}\n\n\nexport { \n    createElement,\n    Component,\n    render\n}"],"sourceRoot":""}